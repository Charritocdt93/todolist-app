<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8" />
    <title>Gestión de TodoItems</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Bootstrap CSS (opcional, para facilitar utilidades flex/spacing) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
          rel="stylesheet" />

    <!-- Tus estilos personalizados -->
    <link href="css/styles.css" rel="stylesheet" />
</head>
<body>
    <div class="container py-4">

        <h1 class="mb-4">Gestión de TodoItems</h1>

        <!-- ──────────────────────────────────────────────────────
          1) Tarjeta “Crear Nuevo TodoItem”
          ────────────────────────────────────────────────────── -->
        <div id="create-section" class="card mb-4">
            <div class="card-body">
                <h2 class="card-title">Crear Nuevo TodoItem</h2>
                <form id="create-form" class="d-flex flex-wrap align-items-center gap-2">
                    <!-- Título -->
                    <div class="flex-grow-1" style="min-width: 200px;">
                        <input id="new-title"
                               type="text"
                               class="form-control"
                               placeholder="Título"
                               required />
                    </div>

                    <!-- Descripción -->
                    <div class="flex-grow-1" style="min-width: 200px;">
                        <input id="new-desc"
                               type="text"
                               class="form-control"
                               placeholder="Descripción"
                               required />
                    </div>

                    <!-- Categoría -->
                    <div style="min-width: 160px;">
                        <select id="new-category" class="form-select" required>
                            <option value="">-- Selecciona categoría --</option>
                            <!-- Se rellenará dinámicamente desde JavaScript -->
                        </select>
                    </div>

                    <!-- Botón Crear -->
                    <div>
                        <button type="submit" class="btn btn-success px-4">Crear</button>
                    </div>

                    <!-- Mensaje de feedback (ocupa toda la fila) -->
                    <div class="w-100">
                        <div id="create-msg" class="message pt-2"></div>
                    </div>
                </form>
            </div>
        </div>

        <!-- ──────────────────────────────────────────────────────
          2) Tarjeta “Listado de TodoItems” (oculta hasta que haya al menos 1 item)
          ────────────────────────────────────────────────────── -->
        <!-- Añadimos la clase "hidden" para que no se vea hasta que el JS la muestre -->
        <div id="list-section" class="card hidden">
            <div class="card-body">
                <h2 class="card-title">Listado de TodoItems</h2>
                <div id="items-container"></div>
            </div>
        </div>

        <!-- Contenedor donde se inyectará el formulario de “Añadir Progresión” -->
        <!-- También puede ir dentro de cada item, pero aquí se muestra globalmente debajo de la lista -->
        <div id="progression-section" class="card hidden mb-4">
            <div class="card-body">
                <h3 class="card-title">Añadir Progresión al TodoItem <span id="prog-item-id"></span></h3>
                <form id="progression-form" class="d-flex flex-wrap align-items-center gap-2">
                    <input id="prog-parent-id" type="hidden" />

                    <!-- Fecha -->
                    <div style="min-width: 180px;">
                        <label for="prog-date" class="form-label mb-0">Fecha:</label>
                        <input id="prog-date" type="date" class="form-control" required />
                    </div>

                    <!-- Porcentaje -->
                    <div style="min-width: 140px;">
                        <label for="prog-percent" class="form-label mb-0">Porcentaje (%):</label>
                        <input id="prog-percent"
                               type="number"
                               class="form-control"
                               min="0"
                               max="100"
                               required />
                    </div>

                    <!-- Botón Registrar -->
                    <div>
                        <button type="submit" class="btn btn-success px-4">Registrar Progresión</button>
                    </div>

                    <!-- Botón Cancelar -->
                    <div>
                        <button id="prog-cancel" type="button" class="btn btn-secondary px-4">
                            Cancelar
                        </button>
                    </div>

                    <!-- Mensaje de error de progresión (ocupa toda la fila) -->
                    <div class="w-100">
                        <div id="prog-msg" class="message pt-2"></div>
                    </div>
                </form>
            </div>
        </div>

        <!-- Tarjeta “Actualizar Descripción del TodoItem” (oculta hasta que el usuario pulse “Actualizar”) -->
        <div id="update-section" class="card hidden mb-4">
            <div class="card-body">
                <h3 class="card-title">Actualizar Descripción del TodoItem <span id="upd-item-id"></span></h3>
                <form id="update-form" class="d-flex flex-wrap align-items-center gap-2">
                    <input id="upd-parent-id" type="hidden" />

                    <!-- Nueva Descripción -->
                    <div class="flex-grow-1" style="min-width: 300px;">
                        <label for="upd-new-desc" class="form-label mb-0">Nueva descripción:</label>
                        <input id="upd-new-desc"
                               type="text"
                               class="form-control"
                               placeholder="Escribe la nueva descripción"
                               required />
                    </div>

                    <!-- Botón Guardar Cambios -->
                    <div>
                        <button type="submit" class="btn btn-warning px-4">Guardar Cambios</button>
                    </div>

                    <!-- Botón Cancelar -->
                    <div>
                        <button id="upd-cancel" type="button" class="btn btn-secondary px-4">
                            Cancelar
                        </button>
                    </div>

                    <!-- Mensaje de error/feedback (ocupa toda la fila) -->
                    <div class="w-100">
                        <div id="upd-msg" class="message pt-2"></div>
                    </div>
                </form>
            </div>
        </div>

    </div>

    <!-- Bootstrap JS (opcional) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Tu JavaScript -->
    <script src="js/app.js"></script>
</body>
</html>
